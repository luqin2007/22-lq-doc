构建语言响应，将文本信息转化为结构化信息，是包含以下方法的类：
- `get_format_instructions() -> str`：指导如何格式化语言模型的输出
- `parse(output: str)`：接收语言模型输出
- `parse_with_prompt(output: str, prompt: str)`：可选，接收一个提示，根据提示修正模型输出

LangChain 自带解析器位于 `langchain.output_parsers` 包中
# PydanticOutputParser

使用 Pydantic 将输出解析为 Json 数据，并提供数据验证、数据转换等功能

1. 创建 Pydantic 模型

![[../../../../../_resources/images/Pasted image 20241110130922.png]]

2. 创建解析器，获取输出提示用于指导大语言模型输出

![[../../../../../_resources/images/Pasted image 20241110131043.png]]

3. 创建提示模板并包含输出提示指导

> [!note] 也可以在模板中包含输出解析器（`output_parser` 参数）

![[../../../../../_resources/images/Pasted image 20241110131322.png]]

4. 生成提示并使用输出解析器输出

![[../../../../../_resources/images/Pasted image 20241110131508.png]] 
# OutputFixingParser

自动修复解析器，用于修复模型返回的数据中的**格式错误**

原理：当格式化错误时，将错误数据和格式化指令传递给大模型，让 LLM 进行相关修复

![[../../../../../_resources/images/Pasted image 20241110131945.png]]
- `parser`：尝试使用的解析器

# RetryWithErrorOutputParser

重试解析器，错误时重新向大模型发起查询并附带更多指导信息，可修复完整性、准确性等问题