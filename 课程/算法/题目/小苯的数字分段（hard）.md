> 北京信息科技大学第十六届程序设计竞赛（校外同步赛）（重现赛）
> https://ac.nowcoder.com/acm/contest/97588/K

难度/题目：
# 题目

**（本题为 hard 版本，与 easy 的区别仅在段中的第一个数字可以作为长度。）**

小苯有一个长度为 $n$ 的数组，他希望将 $a$ 划分成尽可能少的连续且不相交的段，使得以下条件成立：

$\bullet$ 每个 $a_i$ 都恰好属于一个段。  
$\bullet$ 对于每一段，都满足：段中的**第一个数字**或者**最后一个数字**是该段的长度。  
  
小苯希望找到一个最小的分段方案，他想知道最少可以分成多少个段呢，请你帮他算一算吧。
## 输入格式

本题含有多组测试数据。  
第一行一个正整数 $T\ (1 \leq T \leq 1000)$，表示测试数据的组数。  

接下来对于每组测试数据，输出包含两行。

第一行一个正整数 $n\ (2 \leq n \leq 200000)$，表示数组 $a$ 的长度。  
第二行 $n$ 个整数 $a_i\ (1 \leq a_i \leq n)$，表示数组 $a$。  

（保证所有测试数据中，$n$ 的总和不超过 $200000$。）
## 输出格式

对于每组测试数据，如果可以将数组分成若干个段以满足题意，则输出一行一个正整数表示最少分成的段数，否则输出一行一个 $-1$ 即可。
## 样例
### 输入

```
3
5
1 2 3 2 1
4
1 1 1 1
5
4 2 3 4 4
```
### 输出

```
2
4
2
```
### 解释

对于第一组测试数据，可以分为 $\{1,2,3\}$ 和 $\{2, 1\}$ 两段， 其中第一段的最后一个数字 $3$ 可以作为第一段的长度，第二段的第一个数字 $2$ 可以作为第二段的长度。

## 代码限制
  
时间限制：C/C++/Rust/Pascal 1秒，其他语言2秒  
空间限制：C/C++/Rust/Pascal 256 M，其他语言512 M  
64bit IO Format: %lld
# 解析

- [ ] TODO
# 思路

# 答案

```c++

```